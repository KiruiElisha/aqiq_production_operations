[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-07-23 16:40:56.530433",
  "module": "AQIQ Production operations",
  "name": "Job Card",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Job Card",
  "script": "\ndoc.employee = ''",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-07-24 11:13:25.096818",
  "module": "AQIQ Production operations",
  "name": "Job Card Employee",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Job Card Time Log",
  "script": "doc.employee = \"\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-09-04 15:14:05.355593",
  "module": "AQIQ Production operations",
  "name": "Job card Custom",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Job Card",
  "script": "def create_material_request(doc):\r\n    if not doc.items:\r\n        # frappe.msgprint(\"No items found in Job Card; Material Request not created.\")\r\n        return\r\n\r\n    material_request = frappe.new_doc(\"Material Request\")\r\n    material_request.update({\r\n        \"material_request_type\": \"Material Transfer\",\r\n        \"company\": doc.company,\r\n        \"transaction_date\": doc.posting_date,\r\n        \"job_card\": doc.name  # Link to the Job Card\r\n    })\r\n\r\n    items_added = False\r\n    for item in doc.items:\r\n        if item.required_qty > 0:\r\n            material_request.append(\"items\", {\r\n                \"item_code\": item.item_code,\r\n                \"qty\": item.required_qty,\r\n                \"stock_uom\": item.stock_uom,\r\n                \"schedule_date\": doc.expected_start_date,\r\n                \"warehouse\": item.source_warehouse,  # Ensure this is the correct field\r\n                \"job_card\": doc.name  # Link to the Job Card\r\n            })\r\n            items_added = True\r\n\r\n    if items_added:\r\n        material_request.insert()\r\n        material_request.submit()\r\n        frappe.msgprint(f\"Material Request {material_request.name} created and submitted.\")\r\n    else:\r\n        return\r\n        # frappe.msgprint(\"No raw materials required; Material Request not created.\")\r\n\r\ncreate_material_request(doc)\r\n",
  "script_type": "DocType Event"
 }
]